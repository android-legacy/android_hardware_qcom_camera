From dc293622fd29f90bff2d52aee37d76cd96dc6e0d Mon Sep 17 00:00:00 2001
From: Abhishek Kondaveeti <akondave@codeaurora.org>
Date: Mon, 10 Mar 2014 10:24:13 +0530
Subject: [PATCH 120/176] Qcamera2: Fix avtimer time stamp calcuation.

Calculates timestamp correctly in Av timer
case.

Change-Id: I7f3c49f829681c4112c5bfa4c7428671875bfe21
---
 QCamera2/HAL/QCamera2HWICallbacks.cpp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/QCamera2/HAL/QCamera2HWICallbacks.cpp b/QCamera2/HAL/QCamera2HWICallbacks.cpp
index 0211a92..35c7ae1 100644
--- a/QCamera2/HAL/QCamera2HWICallbacks.cpp
+++ b/QCamera2/HAL/QCamera2HWICallbacks.cpp
@@ -667,7 +667,7 @@ void QCamera2HardwareInterface::video_stream_cb_routine(mm_camera_super_buf_t *s
           frame->ts.tv_nsec);
     nsecs_t timeStamp;
     if(pme->mParameters.isAVTimerEnabled() == true) {
-        timeStamp = (((nsecs_t)frame->ts.tv_sec << 32) | frame->ts.tv_nsec) * 1000;
+        timeStamp = (nsecs_t)((frame->ts.tv_sec * 1000000LL) + frame->ts.tv_nsec) * 1000;
     } else {
         timeStamp = nsecs_t(frame->ts.tv_sec) * 1000000000LL + frame->ts.tv_nsec;
     }
-- 
1.8.3.1

